import e from"querystring";var t=/https?|ftp|gopher|file/;function o(o){"string"==typeof o&&(o=d(o));var r=function(e,t,o){var r=e.auth,a=e.hostname,s=e.protocol||"",h=e.pathname||"",c=e.hash||"",p=e.query||"",n=!1;r=r?encodeURIComponent(r).replace(/%3A/i,":")+"@":"",e.host?n=r+e.host:a&&(n=r+(~a.indexOf(":")?"["+a+"]":a),e.port&&(n+=":"+e.port)),p&&"object"==typeof p&&(p=t.encode(p));var l=e.search||p&&"?"+p||"";return s&&":"!==s.substr(-1)&&(s+=":"),e.slashes||(!s||o.test(s))&&!1!==n?(n="//"+(n||""),h&&"/"!==h[0]&&(h="/"+h)):n||(n=""),c&&"#"!==c[0]&&(c="#"+c),l&&"?"!==l[0]&&(l="?"+l),{protocol:s,host:n,pathname:h=h.replace(/[?#]/g,encodeURIComponent),search:l=l.replace("#","%23"),hash:c}}(o,e,t);return""+r.protocol+r.host+r.pathname+r.search+r.hash}var r="http://",a="w.w",s=r+a,h=/^([a-z0-9.+-]*:\/\/\/)([a-z0-9.+-]:\/*)?/i,c=/https?|ftp|gopher|file/;function p(e,t){var a="string"==typeof e?d(e):e;e="object"==typeof e?o(e):e;var p=d(t),n="";a.protocol&&!a.slashes&&(n=a.protocol,e=e.replace(a.protocol,""),n+="/"===t[0]||"/"===e[0]?"/":""),n&&p.protocol&&(n="",p.slashes||(n=p.protocol,t=t.replace(p.protocol,"")));var l=e.match(h);l&&!p.protocol&&(e=e.substr((n=l[1]+(l[2]||"")).length),/^\/\/[^/]/.test(t)&&(n=n.slice(0,-1)));var i=new URL(e,s+"/"),f=new URL(t,i).toString().replace(s,""),u=p.protocol||a.protocol;return u+=a.slashes||p.slashes?"//":"",!n&&u?f=f.replace(r,u):n&&(f=f.replace(r,"")),c.test(f)||~t.indexOf(".")||"/"===e.slice(-1)||"/"===t.slice(-1)||"/"!==f.slice(-1)||(f=f.slice(0,-1)),n&&(f=n+("/"===f[0]?f.substr(1):f)),f}function n(e,t){return d(p(e,t))}function l(){}l.parse=d,l.format=o,l.resolve=p,l.resolveObject=p;var i=/^https?|ftp|gopher|file/,f=/^(.*?)([#?].*)/,u=/^([a-z0-9.+-]*:)(\/{0,3})(.*)/i,m=/^([a-z0-9.+-]*:)?\/\/\/*/i,v=/^([a-z0-9.+-]*:)(\/{0,2})\[(.*)\]$/i;function g(e){try{return decodeURI(e)}catch(t){return e}}function d(t,r,h){if(void 0===r&&(r=!1),void 0===h&&(h=!1),t&&"object"==typeof t&&t instanceof l)return t;var c=(t=t.trim()).match(f);t=c?g(c[1]).replace(/\\/g,"/")+c[2]:g(t).replace(/\\/g,"/"),v.test(t)&&"/"!==t.slice(-1)&&(t+="/");var p=!/(^javascript)/.test(t)&&t.match(u),n=m.test(t),d="";p&&(i.test(p[1])||(d=p[1].toLowerCase(),t=""+p[2]+p[3]),p[2]||(n=!1,i.test(p[1])?(d=p[1],t=""+p[3]):t="//"+p[3]),3!==p[2].length&&1!==p[2].length||(d=p[1],t="/"+p[3]));var b,y=(c?c[1]:t).match(/(:[0-9]+)/),w="";y&&y[1]&&3===y[1].length&&(t=t.replace(w=y[1],w+"00"));var R=new l,U="",j="";try{b=new URL(t)}catch(e){U=e,d||h||!/^\/\//.test(t)||/^\/\/.+[@.]/.test(t)||(j="/",t=t.substr(1));try{b=new URL(t,s)}catch(e){return R.protocol=d,R.href=d,R}}R.slashes=n&&!j,R.host=b.host===a?"":b.host,R.hostname=b.hostname===a?"":b.hostname.replace(/(\[|\])/g,""),R.protocol=U?d||null:b.protocol,R.search=b.search.replace(/\\/g,"%5C"),R.hash=b.hash.replace(/\\/g,"%5C");var C=t.split("#");!R.search&&~C[0].indexOf("?")&&(R.search="?"),R.hash||""!==C[1]||(R.hash="#"),R.query=r?e.decode(b.search.substr(1)):R.search.substr(1),R.pathname=j+g(b.pathname).replace(/"/g,"%22"),"about:"===R.protocol&&"blank"===R.pathname&&(R.protocol="",R.pathname=""),U&&"/"!==t[0]&&(R.pathname=R.pathname.substr(1)),d&&!i.test(d)&&"/"!==t.slice(-1)&&"/"===R.pathname&&(R.pathname=""),R.path=R.pathname+R.search,R.auth=[b.username,b.password].map(decodeURIComponent).filter(Boolean).join(":"),R.port=b.port,w&&(R.host=R.host.replace(w+"00",w),R.port=R.port.slice(0,-2)),R.href=j?""+R.pathname+R.search+R.hash:o(R);var O=/^(file)/.test(R.href)?["host","hostname"]:[];return Object.keys(R).forEach(function(e){~O.indexOf(e)||(R[e]=R[e]||null)}),R}export{d as parse,o as format,p as resolve,n as resolveObject,l as Url};
//# sourceMappingURL=index.mjs.map
